!function(e){var t={};function o(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)o.d(n,s,function(t){return e[t]}.bind(null,s));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,o){"use strict";o.r(t);var n={};function s(e,t,o){let n;return"#text"===e.nodeName?n=o.document.createTextNode(e.data):"#comment"===e.nodeName?n=o.document.createComment(e.data):(t?n=o.document.createElementNS("http://www.w3.org/2000/svg",e.nodeName):"svg"===e.nodeName.toLowerCase()?(n=o.document.createElementNS("http://www.w3.org/2000/svg","svg"),t=!0):n=o.document.createElement(e.nodeName),e.attributes&&Object.entries(e.attributes).forEach(([e,t])=>n.setAttribute(e,t)),e.childNodes&&e.childNodes.forEach(e=>n.appendChild(s(e,t,o))),o.valueDiffing&&(e.value&&(n.value=e.value),e.checked&&(n.checked=e.checked),e.selected&&(n.selected=e.selected))),n}function i(e,t){for(t=t.slice();t.length>0;){if(!e.childNodes)return!1;const o=t.splice(0,1)[0];e=e.childNodes[o]}return e}function l(e,t,o){let n,l,a,c,r,u=i(e,t[o._const.route]);const d={diff:t,node:u};if(o.preDiffApply(d))return!0;switch(t[o._const.action]){case o._const.addAttribute:if(!u||!u.setAttribute)return!1;u.setAttribute(t[o._const.name],t[o._const.value]);break;case o._const.modifyAttribute:if(!u||!u.setAttribute)return!1;u.setAttribute(t[o._const.name],t[o._const.newValue]),"INPUT"===u.nodeName&&"value"===t[o._const.name]&&(u.value=t[o._const.newValue]);break;case o._const.removeAttribute:if(!u||!u.removeAttribute)return!1;u.removeAttribute(t[o._const.name]);break;case o._const.modifyTextElement:if(!u||3!==u.nodeType)return!1;o.textDiff(u,u.data,t[o._const.oldValue],t[o._const.newValue]);break;case o._const.modifyValue:if(!u||void 0===u.value)return!1;u.value=t[o._const.newValue];break;case o._const.modifyComment:if(!u||void 0===u.data)return!1;o.textDiff(u,u.data,t[o._const.oldValue],t[o._const.newValue]);break;case o._const.modifyChecked:if(!u||void 0===u.checked)return!1;u.checked=t[o._const.newValue];break;case o._const.modifySelected:if(!u||void 0===u.selected)return!1;u.selected=t[o._const.newValue];break;case o._const.replaceElement:u.parentNode.replaceChild(s(t[o._const.newValue],"http://www.w3.org/2000/svg"===u.namespaceURI,o),u);break;case o._const.relocateGroup:c=Array(...new Array(t.groupLength)).map(()=>u.removeChild(u.childNodes[t[o._const.from]])),c.forEach((e,n)=>{0===n&&(l=u.childNodes[t[o._const.to]]),u.insertBefore(e,l||null)});break;case o._const.removeElement:u.parentNode.removeChild(u);break;case o._const.addElement:a=t[o._const.route].slice(),r=a.splice(a.length-1,1)[0],u=i(e,a),u.insertBefore(s(t[o._const.element],"http://www.w3.org/2000/svg"===u.namespaceURI,o),u.childNodes[r]||null);break;case o._const.removeTextElement:if(!u||3!==u.nodeType)return!1;u.parentNode.removeChild(u);break;case o._const.addTextElement:if(a=t[o._const.route].slice(),r=a.splice(a.length-1,1)[0],n=o.document.createTextNode(t[o._const.value]),u=i(e,a),!u||!u.childNodes)return!1;u.insertBefore(n,u.childNodes[r]||null);break;default:console.log("unknown action")}return d.newNode=n,o.postDiffApply(d),!0}function a(e,t,o){const n=e[t];e[t]=e[o],e[o]=n}function c(e,t,o){t.length||(t=[t]),(t=t.slice()).reverse(),t.forEach(t=>{!function(e,t,o){switch(t[o._const.action]){case o._const.addAttribute:t[o._const.action]=o._const.removeAttribute,l(e,t,o);break;case o._const.modifyAttribute:a(t,o._const.oldValue,o._const.newValue),l(e,t,o);break;case o._const.removeAttribute:t[o._const.action]=o._const.addAttribute,l(e,t,o);break;case o._const.modifyTextElement:case o._const.modifyValue:case o._const.modifyComment:case o._const.modifyChecked:case o._const.modifySelected:case o._const.replaceElement:a(t,o._const.oldValue,o._const.newValue),l(e,t,o);break;case o._const.relocateGroup:a(t,o._const.from,o._const.to),l(e,t,o);break;case o._const.removeElement:t[o._const.action]=o._const.addElement,l(e,t,o);break;case o._const.addElement:t[o._const.action]=o._const.removeElement,l(e,t,o);break;case o._const.removeTextElement:t[o._const.action]=o._const.addTextElement,l(e,t,o);break;case o._const.addTextElement:t[o._const.action]=o._const.removeTextElement,l(e,t,o);break;default:console.log("unknown action")}}(e,t,o)})}o.r(n),o.d(n,"DiffDOM",(function(){return S})),o.d(n,"nodeToObj",(function(){return v})),o.d(n,"stringToObj",(function(){return O})),o.d(n,"TraceLogger",(function(){return j}));class r{constructor(e={}){Object.entries(e).forEach(([e,t])=>this[e]=t)}toString(){return JSON.stringify(this)}setValue(e,t){return this[e]=t,this}}function u(e){const t=[];return t.push(e.nodeName),"#text"!==e.nodeName&&"#comment"!==e.nodeName&&e.attributes&&(e.attributes.class&&t.push(`${e.nodeName}.${e.attributes.class.replace(/ /g,".")}`),e.attributes.id&&t.push(`${e.nodeName}#${e.attributes.id}`)),t}function d(e){const t={},o={};return e.forEach(e=>{u(e).forEach(e=>{const n=e in t;n||e in o?n&&(delete t[e],o[e]=!0):t[e]=!0})}),t}function h(e,t){const o=d(e),n=d(t),s={};return Object.keys(o).forEach(e=>{n[e]&&(s[e]=!0)}),s}function f(e){return delete e.outerDone,delete e.innerDone,delete e.valueDone,!e.childNodes||e.childNodes.every(f)}function p(e,t){if(!["nodeName","value","checked","selected","data"].every(o=>e[o]===t[o]))return!1;if(Boolean(e.attributes)!==Boolean(t.attributes))return!1;if(Boolean(e.childNodes)!==Boolean(t.childNodes))return!1;if(e.attributes){const o=Object.keys(e.attributes),n=Object.keys(t.attributes);if(o.length!==n.length)return!1;if(!o.every(o=>e.attributes[o]===t.attributes[o]))return!1}if(e.childNodes){if(e.childNodes.length!==t.childNodes.length)return!1;if(!e.childNodes.every((e,o)=>p(e,t.childNodes[o])))return!1}return!0}function m(e,t,o,n,s){if(!e||!t)return!1;if(e.nodeName!==t.nodeName)return!1;if("#text"===e.nodeName)return!!s||e.data===t.data;if(e.nodeName in o)return!0;if(e.attributes&&t.attributes){if(e.attributes.id){if(e.attributes.id!==t.attributes.id)return!1;if(`${e.nodeName}#${e.attributes.id}`in o)return!0}if(e.attributes.class&&e.attributes.class===t.attributes.class){if(`${e.nodeName}.${e.attributes.class.replace(/ /g,".")}`in o)return!0}}if(n)return!0;const i=e.childNodes?e.childNodes.slice().reverse():[],l=t.childNodes?t.childNodes.slice().reverse():[];if(i.length!==l.length)return!1;if(s)return i.every((e,t)=>e.nodeName===l[t].nodeName);{const e=h(i,l);return i.every((t,o)=>m(t,l[o],e,!0,!0))}}function _(e){return JSON.parse(JSON.stringify(e))}function V(e,t,o,n){let s=0,i=[];const l=e.length,a=t.length,c=Array(...new Array(l+1)).map(()=>[]),r=h(e,t);let d=l===a;d&&e.some((e,o)=>{const n=u(e),s=u(t[o]);return n.length!==s.length?(d=!1,!0):(n.some((e,t)=>{if(e!==s[t])return d=!1,!0}),!d||void 0)});for(let u=0;u<l;u++){const l=e[u];for(let e=0;e<a;e++){const a=t[e];o[u]||n[e]||!m(l,a,r,d)?c[u+1][e+1]=0:(c[u+1][e+1]=c[u][e]?c[u][e]+1:1,c[u+1][e+1]>=s&&(s=c[u+1][e+1],i=[u+1,e+1]))}}return 0!==s&&{oldValue:i[0]-s,newValue:i[1]-s,length:s}}function g(e,t){return Array(...new Array(e)).map(()=>t)}class b{constructor(){this.list=[]}add(e){this.list.push(...e)}forEach(e){this.list.forEach(t=>e(t))}}function N(e,t){let o,n,s=e;for(t=t.slice();t.length>0;){if(!s.childNodes)return!1;n=t.splice(0,1)[0],o=s,s=s.childNodes[n]}return{node:s,parentNode:o,nodeIndex:n}}function w(e,t,o){return t.forEach(t=>{!function(e,t,o){const n=N(e,t[o._const.route]);let s=n.node;const i=n.parentNode,l=n.nodeIndex,a=[],c={diff:t,node:s};if(o.preVirtualDiffApply(c))return!0;let r,u,d,h;switch(t[o._const.action]){case o._const.addAttribute:s.attributes||(s.attributes={}),s.attributes[t[o._const.name]]=t[o._const.value],"checked"===t[o._const.name]?s.checked=!0:"selected"===t[o._const.name]?s.selected=!0:"INPUT"===s.nodeName&&"value"===t[o._const.name]&&(s.value=t[o._const.value]);break;case o._const.modifyAttribute:s.attributes[t[o._const.name]]=t[o._const.newValue];break;case o._const.removeAttribute:delete s.attributes[t[o._const.name]],0===Object.keys(s.attributes).length&&delete s.attributes,"checked"===t[o._const.name]?s.checked=!1:"selected"===t[o._const.name]?delete s.selected:"INPUT"===s.nodeName&&"value"===t[o._const.name]&&delete s.value;break;case o._const.modifyTextElement:s.data=t[o._const.newValue];break;case o._const.modifyValue:s.value=t[o._const.newValue];break;case o._const.modifyComment:s.data=t[o._const.newValue];break;case o._const.modifyChecked:s.checked=t[o._const.newValue];break;case o._const.modifySelected:s.selected=t[o._const.newValue];break;case o._const.replaceElement:r=_(t[o._const.newValue]),r.outerDone=!0,r.innerDone=!0,r.valueDone=!0,i.childNodes[l]=r;break;case o._const.relocateGroup:u=s.childNodes.splice(t[o._const.from],t.groupLength).reverse(),u.forEach(e=>s.childNodes.splice(t[o._const.to],0,e)),s.subsets&&s.subsets.forEach(e=>{if(t[o._const.from]<t[o._const.to]&&e.oldValue<=t[o._const.to]&&e.oldValue>t[o._const.from]){e.oldValue-=t.groupLength;const n=e.oldValue+e.length-t[o._const.to];n>0&&(a.push({oldValue:t[o._const.to]+t.groupLength,newValue:e.newValue+e.length-n,length:n}),e.length-=n)}else if(t[o._const.from]>t[o._const.to]&&e.oldValue>t[o._const.to]&&e.oldValue<t[o._const.from]){e.oldValue+=t.groupLength;const n=e.oldValue+e.length-t[o._const.to];n>0&&(a.push({oldValue:t[o._const.to]+t.groupLength,newValue:e.newValue+e.length-n,length:n}),e.length-=n)}else e.oldValue===t[o._const.from]&&(e.oldValue=t[o._const.to])});break;case o._const.removeElement:i.childNodes.splice(l,1),i.subsets&&i.subsets.forEach(e=>{e.oldValue>l?e.oldValue-=1:e.oldValue===l?e.delete=!0:e.oldValue<l&&e.oldValue+e.length>l&&(e.oldValue+e.length-1===l?e.length--:(a.push({newValue:e.newValue+l-e.oldValue,oldValue:l,length:e.length-l+e.oldValue-1}),e.length=l-e.oldValue))}),s=i;break;case o._const.addElement:d=t[o._const.route].slice(),h=d.splice(d.length-1,1)[0],s=N(e,d).node,r=_(t[o._const.element]),r.outerDone=!0,r.innerDone=!0,r.valueDone=!0,s.childNodes||(s.childNodes=[]),h>=s.childNodes.length?s.childNodes.push(r):s.childNodes.splice(h,0,r),s.subsets&&s.subsets.forEach(e=>{if(e.oldValue>=h)e.oldValue+=1;else if(e.oldValue<h&&e.oldValue+e.length>h){const t=e.oldValue+e.length-h;a.push({newValue:e.newValue+e.length-t,oldValue:h+1,length:t}),e.length-=t}});break;case o._const.removeTextElement:i.childNodes.splice(l,1),"TEXTAREA"===i.nodeName&&delete i.value,i.subsets&&i.subsets.forEach(e=>{e.oldValue>l?e.oldValue-=1:e.oldValue===l?e.delete=!0:e.oldValue<l&&e.oldValue+e.length>l&&(e.oldValue+e.length-1===l?e.length--:(a.push({newValue:e.newValue+l-e.oldValue,oldValue:l,length:e.length-l+e.oldValue-1}),e.length=l-e.oldValue))}),s=i;break;case o._const.addTextElement:d=t[o._const.route].slice(),h=d.splice(d.length-1,1)[0],r={},r.nodeName="#text",r.data=t[o._const.value],s=N(e,d).node,s.childNodes||(s.childNodes=[]),h>=s.childNodes.length?s.childNodes.push(r):s.childNodes.splice(h,0,r),"TEXTAREA"===s.nodeName&&(s.value=t[o._const.newValue]),s.subsets&&s.subsets.forEach(e=>{if(e.oldValue>=h&&(e.oldValue+=1),e.oldValue<h&&e.oldValue+e.length>h){const t=e.oldValue+e.length-h;a.push({newValue:e.newValue+e.length-t,oldValue:h+1,length:t}),e.length-=t}});break;default:console.log("unknown action")}s.subsets&&(s.subsets=s.subsets.filter(e=>!e.delete&&e.oldValue!==e.newValue),a.length&&(s.subsets=s.subsets.concat(a))),c.newNode=r,o.postVirtualDiffApply(c)}(e,t,o)}),!0}function v(e,t={}){const o={};if(o.nodeName=e.nodeName,"#text"===o.nodeName||"#comment"===o.nodeName)o.data=e.data;else{if(e.attributes&&e.attributes.length>0){o.attributes={};Array.prototype.slice.call(e.attributes).forEach(e=>o.attributes[e.name]=e.value)}if("TEXTAREA"===o.nodeName)o.value=e.value;else if(e.childNodes&&e.childNodes.length>0){o.childNodes=[];Array.prototype.slice.call(e.childNodes).forEach(e=>o.childNodes.push(v(e,t)))}t.valueDiffing&&(void 0!==e.checked&&e.type&&["radio","checkbox"].includes(e.type.toLowerCase())?o.checked=e.checked:void 0!==e.value&&(o.value=e.value),void 0!==e.selected&&(o.selected=e.selected))}return o}const y=/<(?:"[^"]*"['"]*|'[^']*'['"]*|[^'">])+>/g,E=Object.create?Object.create(null):{},k=/\s([^'"/\s><]+?)[\s/>]|([^\s=]+)=\s?(".*?"|'.*?')/g;function x(e){return e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}const A={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,menuItem:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0};function D(e){const t={nodeName:"",attributes:{}};let o=e.match(/<\/?([^\s]+?)[/\s>]/);if(o&&(t.nodeName=o[1].toUpperCase(),(A[o[1].toLowerCase()]||"/"===e.charAt(e.length-2))&&(t.voidElement=!0),t.nodeName.startsWith("!--"))){const t=e.indexOf("--\x3e");return{type:"comment",data:-1!==t?e.slice(4,t):""}}let n=new RegExp(k),s=null,i=!1;for(;!i;)if(s=n.exec(e),null===s)i=!0;else if(s[0].trim())if(s[1]){let e=s[1].trim(),o=[e,""];e.indexOf("=")>-1&&(o=e.split("=")),t.attributes[o[0]]=o[1],n.lastIndex--}else s[2]&&(t.attributes[s[2]]=s[3].trim().substring(1,s[3].length-1));return t}function O(e){return function e(t){return delete t.voidElement,t.childNodes&&t.childNodes.forEach(t=>e(t)),t}(function(e,t={components:E}){const o=[];let n,s=-1;const i=[];let l=!1;return e.replace(y,(a,c)=>{if(l){if(a!==`</${n.nodeName}>`)return;l=!1}const r="/"!==a.charAt(1),u=a.startsWith("\x3c!--"),d=c+a.length,h=e.charAt(d);let f;if(u){const e=D(a);return s<0?(o.push(e),o):(f=i[s],f&&(f.childNodes||(f.childNodes=[]),f.childNodes.push(e)),o)}if(r&&(n=D(a),s++,"tag"===n.type&&t.components[n.nodeName]&&(n.type="component",l=!0),n.voidElement||l||!h||"<"===h||(n.childNodes||(n.childNodes=[]),n.childNodes.push({nodeName:"#text",data:x(e.slice(d,e.indexOf("<",d)))})),0===s&&o.push(n),f=i[s-1],f&&(f.childNodes||(f.childNodes=[]),f.childNodes.push(n)),i[s]=n),(!r||n.voidElement)&&(s--,!l&&"<"!==h&&h)){f=-1===s?o:i[s].childNodes||[];const t=e.indexOf("<",d),n=x(e.slice(d,-1===t?void 0:t));f.push({nodeName:"#text",data:n})}}),o[0]}(e))}class T{constructor(e,t,o){this.options=o,this.t1=e instanceof HTMLElement?v(e,this.options):"string"==typeof e?O(e,this.options):JSON.parse(JSON.stringify(e)),this.t2=t instanceof HTMLElement?v(t,this.options):"string"==typeof t?O(t,this.options):JSON.parse(JSON.stringify(t)),this.diffcount=0,this.foundAll=!1,this.debug&&(this.t1Orig=v(e,this.options),this.t2Orig=v(t,this.options)),this.tracker=new b}init(){return this.findDiffs(this.t1,this.t2)}findDiffs(e,t){let o;do{if(this.options.debug&&(this.diffcount+=1,this.diffcount>this.options.diffcap))throw window.diffError=[this.t1Orig,this.t2Orig],new Error(`surpassed diffcap:${JSON.stringify(this.t1Orig)} -> ${JSON.stringify(this.t2Orig)}`);o=this.findNextDiff(e,t,[]),0===o.length&&(p(e,t)||(this.foundAll?console.error("Could not find remaining diffs!"):(this.foundAll=!0,f(e),o=this.findNextDiff(e,t,[])))),o.length>0&&(this.foundAll=!1,this.tracker.add(o),w(e,o,this.options))}while(o.length>0);return this.tracker.list}findNextDiff(e,t,o){let n,s;if(this.options.maxDepth&&o.length>this.options.maxDepth)return[];if(!e.outerDone){if(n=this.findOuterDiff(e,t,o),this.options.filterOuterDiff&&(s=this.options.filterOuterDiff(e,t,n),s&&(n=s)),n.length>0)return e.outerDone=!0,n;e.outerDone=!0}if(!e.innerDone){if(n=this.findInnerDiff(e,t,o),n.length>0)return n;e.innerDone=!0}if(this.options.valueDiffing&&!e.valueDone){if(n=this.findValueDiff(e,t,o),n.length>0)return e.valueDone=!0,n;e.valueDone=!0}return[]}findOuterDiff(e,t,o){const n=[];let s,i,l,a,c,u;if(e.nodeName!==t.nodeName){if(!o.length)throw new Error("Top level nodes have to be of the same kind.");return[(new r).setValue(this.options._const.action,this.options._const.replaceElement).setValue(this.options._const.oldValue,_(e)).setValue(this.options._const.newValue,_(t)).setValue(this.options._const.route,o)]}if(o.length&&this.options.maxNodeDiffCount<Math.abs((e.childNodes||[]).length-(t.childNodes||[]).length))return[(new r).setValue(this.options._const.action,this.options._const.replaceElement).setValue(this.options._const.oldValue,_(e)).setValue(this.options._const.newValue,_(t)).setValue(this.options._const.route,o)];if(e.data!==t.data)return"#text"===e.nodeName?[(new r).setValue(this.options._const.action,this.options._const.modifyTextElement).setValue(this.options._const.route,o).setValue(this.options._const.oldValue,e.data).setValue(this.options._const.newValue,t.data)]:[(new r).setValue(this.options._const.action,this.options._const.modifyComment).setValue(this.options._const.route,o).setValue(this.options._const.oldValue,e.data).setValue(this.options._const.newValue,t.data)];for(i=e.attributes?Object.keys(e.attributes).sort():[],l=t.attributes?Object.keys(t.attributes).sort():[],a=i.length,u=0;u<a;u++)s=i[u],c=l.indexOf(s),-1===c?n.push((new r).setValue(this.options._const.action,this.options._const.removeAttribute).setValue(this.options._const.route,o).setValue(this.options._const.name,s).setValue(this.options._const.value,e.attributes[s])):(l.splice(c,1),e.attributes[s]!==t.attributes[s]&&n.push((new r).setValue(this.options._const.action,this.options._const.modifyAttribute).setValue(this.options._const.route,o).setValue(this.options._const.name,s).setValue(this.options._const.oldValue,e.attributes[s]).setValue(this.options._const.newValue,t.attributes[s])));for(a=l.length,u=0;u<a;u++)s=l[u],n.push((new r).setValue(this.options._const.action,this.options._const.addAttribute).setValue(this.options._const.route,o).setValue(this.options._const.name,s).setValue(this.options._const.value,t.attributes[s]));return n}findInnerDiff(e,t,o){const n=e.childNodes?e.childNodes.slice():[],s=t.childNodes?t.childNodes.slice():[],i=Math.max(n.length,s.length);let l=Math.abs(n.length-s.length),a=[],c=0;if(!this.options.maxChildCount||i<this.options.maxChildCount){const n=e.subsets&&e.subsetsAge--?e.subsets:e.childNodes&&t.childNodes?function(e,t){const o=e.childNodes?e.childNodes:[],n=t.childNodes?t.childNodes:[],s=g(o.length,!1),i=g(n.length,!1),l=[];let a=!0;const c=function(){return arguments[1]};for(;a;)if(a=V(o,n,s,i),a){l.push(a);Array(...new Array(a.length)).map(c).forEach(e=>{return t=e,s[a.oldValue+t]=!0,void(i[a.newValue+t]=!0);var t})}return e.subsets=l,e.subsetsAge=100,l}(e,t):[];if(n.length>0&&(a=this.attemptGroupRelocation(e,t,n,o),a.length>0))return a}for(let e=0;e<i;e+=1){const t=n[e],u=s[e];l&&(t&&!u?"#text"===t.nodeName?(a.push((new r).setValue(this.options._const.action,this.options._const.removeTextElement).setValue(this.options._const.route,o.concat(c)).setValue(this.options._const.value,t.data)),c-=1):(a.push((new r).setValue(this.options._const.action,this.options._const.removeElement).setValue(this.options._const.route,o.concat(c)).setValue(this.options._const.element,_(t))),c-=1):u&&!t&&("#text"===u.nodeName?a.push((new r).setValue(this.options._const.action,this.options._const.addTextElement).setValue(this.options._const.route,o.concat(c)).setValue(this.options._const.value,u.data)):a.push((new r).setValue(this.options._const.action,this.options._const.addElement).setValue(this.options._const.route,o.concat(c)).setValue(this.options._const.element,_(u))))),t&&u&&(!this.options.maxChildCount||i<this.options.maxChildCount?a=a.concat(this.findNextDiff(t,u,o.concat(c))):p(t,u)||(n.length>s.length?("#text"===t.nodeName?a.push((new r).setValue(this.options._const.action,this.options._const.removeTextElement).setValue(this.options._const.route,o.concat(c)).setValue(this.options._const.value,t.data)):a.push((new r).setValue(this.options._const.action,this.options._const.removeElement).setValue(this.options._const.element,_(t)).setValue(this.options._const.route,o.concat(c))),n.splice(e,1),e-=1,c-=1,l-=1):n.length<s.length?(a=a.concat([(new r).setValue(this.options._const.action,this.options._const.addElement).setValue(this.options._const.element,_(u)).setValue(this.options._const.route,o.concat(c))]),n.splice(e,0,{}),l-=1):a=a.concat([(new r).setValue(this.options._const.action,this.options._const.replaceElement).setValue(this.options._const.oldValue,_(t)).setValue(this.options._const.newValue,_(u)).setValue(this.options._const.route,o.concat(c))]))),c+=1}return e.innerDone=!0,a}attemptGroupRelocation(e,t,o,n){const s=function(e,t,o){const n=e.childNodes?g(e.childNodes.length,!0):[],s=t.childNodes?g(t.childNodes.length,!0):[];let i=0;return o.forEach(e=>{const t=e.oldValue+e.length,o=e.newValue+e.length;for(let o=e.oldValue;o<t;o+=1)n[o]=i;for(let t=e.newValue;t<o;t+=1)s[t]=i;i+=1}),{gaps1:n,gaps2:s}}(e,t,o),i=s.gaps1,l=s.gaps2;let a,c,u,d,h,f,p=Math.min(i.length,l.length);const V=[];for(let s=0,g=0;s<p;g+=1,s+=1)if(!0===i[s])if(d=e.childNodes[g],"#text"===d.nodeName)if("#text"===t.childNodes[s].nodeName){if(d.data!==t.childNodes[s].data){for(f=g;e.childNodes.length>f+1&&"#text"===e.childNodes[f+1].nodeName;)if(f+=1,t.childNodes[s].data===e.childNodes[f].data){h=!0;break}if(!h)return V.push((new r).setValue(this.options._const.action,this.options._const.modifyTextElement).setValue(this.options._const.route,n.concat(s)).setValue(this.options._const.oldValue,d.data).setValue(this.options._const.newValue,t.childNodes[s].data)),V}}else V.push((new r).setValue(this.options._const.action,this.options._const.removeTextElement).setValue(this.options._const.route,n.concat(s)).setValue(this.options._const.value,d.data)),i.splice(s,1),p=Math.min(i.length,l.length),s-=1;else V.push((new r).setValue(this.options._const.action,this.options._const.removeElement).setValue(this.options._const.route,n.concat(s)).setValue(this.options._const.element,_(d))),i.splice(s,1),p=Math.min(i.length,l.length),s-=1;else if(!0===l[s])d=t.childNodes[s],"#text"===d.nodeName?(V.push((new r).setValue(this.options._const.action,this.options._const.addTextElement).setValue(this.options._const.route,n.concat(s)).setValue(this.options._const.value,d.data)),i.splice(s,0,!0),p=Math.min(i.length,l.length),g-=1):(V.push((new r).setValue(this.options._const.action,this.options._const.addElement).setValue(this.options._const.route,n.concat(s)).setValue(this.options._const.element,_(d))),i.splice(s,0,!0),p=Math.min(i.length,l.length),g-=1);else if(i[s]!==l[s]){if(V.length>0)return V;if(u=o[i[s]],c=Math.min(u.newValue,e.childNodes.length-u.length),c!==u.oldValue){a=!1;for(let t=0;t<u.length;t+=1)m(e.childNodes[c+t],e.childNodes[u.oldValue+t],[],!1,!0)||(a=!0);if(a)return[(new r).setValue(this.options._const.action,this.options._const.relocateGroup).setValue("groupLength",u.length).setValue(this.options._const.from,u.oldValue).setValue(this.options._const.to,c).setValue(this.options._const.route,n)]}}return V}findValueDiff(e,t,o){const n=[];return e.selected!==t.selected&&n.push((new r).setValue(this.options._const.action,this.options._const.modifySelected).setValue(this.options._const.oldValue,e.selected).setValue(this.options._const.newValue,t.selected).setValue(this.options._const.route,o)),(e.value||t.value)&&e.value!==t.value&&"OPTION"!==e.nodeName&&n.push((new r).setValue(this.options._const.action,this.options._const.modifyValue).setValue(this.options._const.oldValue,e.value||"").setValue(this.options._const.newValue,t.value||"").setValue(this.options._const.route,o)),e.checked!==t.checked&&n.push((new r).setValue(this.options._const.action,this.options._const.modifyChecked).setValue(this.options._const.oldValue,e.checked).setValue(this.options._const.newValue,t.checked).setValue(this.options._const.route,o)),n}}const C={debug:!1,diffcap:10,maxDepth:!1,maxChildCount:50,valueDiffing:!0,textDiff(e,t,o,n){e.data=n},preVirtualDiffApply(){},postVirtualDiffApply(){},preDiffApply(){},postDiffApply(){},filterOuterDiff:null,compress:!1,_const:!1,document:!(!window||!window.document)&&window.document};class S{constructor(e={}){if(this.options=e,Object.entries(C).forEach(([e,t])=>{Object.prototype.hasOwnProperty.call(this.options,e)||(this.options[e]=t)}),!this.options._const){const e=["addAttribute","modifyAttribute","removeAttribute","modifyTextElement","relocateGroup","removeElement","addElement","removeTextElement","addTextElement","replaceElement","modifyValue","modifyChecked","modifySelected","modifyComment","action","route","oldValue","newValue","element","group","from","to","name","value","data","attributes","nodeName","childNodes","checked","selected"];this.options._const={},this.options.compress?e.forEach((e,t)=>this.options._const[e]=t):e.forEach(e=>this.options._const[e]=e)}this.DiffFinder=T}apply(e,t){return function(e,t,o){return t.every(t=>l(e,t,o))}(e,t,this.options)}undo(e,t){return c(e,t,this.options)}diff(e,t){return new this.DiffFinder(e,t,this.options).init()}}class j{constructor(e={}){this.pad="│   ",this.padding="",this.tick=1,this.messages=[];const t=(e,t)=>{const o=e[t];e[t]=(...n)=>{this.fin(t,Array.prototype.slice.call(n));const s=o.apply(e,n);return this.fout(t,s),s}};for(let o in e)"function"==typeof e[o]&&t(e,o);this.log("┌ TRACELOG START")}fin(e,t){this.padding+=this.pad,this.log("├─> entering "+e,t)}fout(e,t){this.log("│<──┘ generated return value",t),this.padding=this.padding.substring(0,this.padding.length-this.pad.length)}format(e,t){return`${function(e){for(e=""+e;e.length<4;)e="0"+e;return e}(t)}> ${this.padding}${e}`}log(){let e=Array.prototype.slice.call(arguments);const t=function(e){return e?"string"==typeof e?e:e instanceof HTMLElement?e.outerHTML||"<empty>":e instanceof Array?`[${e.map(t).join(",")}]`:e.toString()||e.valueOf()||"<unknown>":"<falsey>"};e=e.map(t).join(", "),this.messages.push(this.format(e,this.tick++))}toString(){let e="└───";for(;e.length<=this.padding.length+this.pad.length;)e+="×   ";let t=this.padding;return this.padding="",e=this.format(e,this.tick),this.padding=t,`${this.messages.join("\n")}\n${e}`}}window.diffDom=n}]);